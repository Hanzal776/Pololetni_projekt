<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hern칤 Sk칩re</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        h1 {
            text-align: center;
            color: white;
            margin-bottom: 30px;
            font-size: 2.5em;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        .card {
            background: white;
            border-radius: 10px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }

        .card h2 {
            color: #667eea;
            margin-bottom: 20px;
            border-bottom: 2px solid #667eea;
            padding-bottom: 10px;
        }

        .form-group {
            margin-bottom: 15px;
        }

        label {
            display: block;
            margin-bottom: 5px;
            color: #333;
            font-weight: 500;
        }

        input, textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 1em;
            transition: border-color 0.3s;
        }

        input:focus, textarea:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 5px rgba(102, 126, 234, 0.2);
        }

        button {
            background: #667eea;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 500;
            transition: background 0.3s;
        }

        button:hover {
            background: #764ba2;
        }

        button.delete {
            background: #e74c3c;
            padding: 5px 10px;
            font-size: 0.9em;
        }

        button.delete:hover {
            background: #c0392b;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        th {
            background: #f5f5f5;
            color: #333;
            padding: 12px;
            text-align: left;
            font-weight: 600;
            border-bottom: 2px solid #ddd;
        }

        td {
            padding: 12px;
            border-bottom: 1px solid #eee;
        }

        tr:hover {
            background: #f9f9f9;
        }

        .leaderboard {
            grid-column: 1 / -1;
        }

        .medal {
            display: inline-block;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            text-align: center;
            line-height: 30px;
            font-weight: bold;
            color: white;
            margin-right: 10px;
        }

        .gold { background: #ffd700; color: #333; }
        .silver { background: #c0c0c0; color: #333; }
        .bronze { background: #cd7f32; }

        .player-list {
            list-style: none;
        }

        .player-item {
            background: #f9f9f9;
            padding: 10px;
            margin-bottom: 10px;
            border-radius: 5px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .player-info {
            flex-grow: 1;
        }

        .player-name {
            font-weight: 600;
            color: #333;
        }

        .actions {
            display: flex;
            gap: 10px;
        }

        .success {
            color: #27ae60;
            padding: 10px;
            background: #d5f4e6;
            border-radius: 5px;
            margin-bottom: 15px;
        }

        .error {
            color: #e74c3c;
            padding: 10px;
            background: #fadbd8;
            border-radius: 5px;
            margin-bottom: 15px;
        }

        @media (max-width: 768px) {
            .content {
                grid-template-columns: 1fr;
            }

            .leaderboard {
                grid-column: 1;
            }

            h1 {
                font-size: 1.8em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>游꿡 Po캜칤t치n칤 Hern칤ho Sk칩re</h1>

        <div class="content">
            <!-- Panel pro p콏id치n칤 hr치캜e -->
            <div class="card">
                <h2>P콏idat Hr치캜e</h2>
                <div id="playerMessage"></div>
                <form id="addPlayerForm">
                    <div class="form-group">
                        <label for="playerName">Jm칠no hr치캜e:</label>
                        <input type="text" id="playerName" required>
                    </div>
                    <button type="submit">P콏idat hr치캜e</button>
                </form>

                <h3 style="margin-top: 25px; color: #333;">Hr치캜i:</h3>
                <ul id="playersList" class="player-list"></ul>
            </div>

            <!-- Panel pro p콏id치n칤 sk칩re -->
            <div class="card">
                <h2>Zaznamenat Sk칩re</h2>
                <div id="scoreMessage"></div>
                <form id="addScoreForm">
                    <div class="form-group">
                        <label for="playerSelect">Vyberte hr치캜e:</label>
                        <select id="playerSelect" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;" required>
                            <option value="">-- Vyberte hr치캜e --</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="scoreValue">Sk칩re:</label>
                        <input type="number" id="scoreValue" required>
                    </div>
                    <div class="form-group">
                        <label for="scoreNotes">Pozn치mka (voliteln칠):</label>
                        <textarea id="scoreNotes" rows="2"></textarea>
                    </div>
                    <button type="submit">Zaznamenat sk칩re</button>
                </form>
            </div>

            <!-- Leaderboard -->
            <div class="card leaderboard">
                <h2>游끥 Leaderboard</h2>
                <table>
                    <thead>
                        <tr>
                            <th>Po콏ad칤</th>
                            <th>Hr치캜</th>
                            <th>Celkov칠 Sk칩re</th>
                            <th>Po캜et Her</th>
                            <th>Pr콢m캩r</th>
                        </tr>
                    </thead>
                    <tbody id="leaderboardBody">
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        // Zv칳코it sk칩re hr치캜e
        async function loadPlayers() {
            try {
                const response = await fetch('/api/players');
                const players = await response.json();
                
                // Aktualizovat seznam hr치캜콢
                const playersList = document.getElementById('playersList');
                playersList.innerHTML = '';
                players.forEach(player => {
                    const li = document.createElement('li');
                    li.className = 'player-item';
                    li.innerHTML = `
                        <div class="player-info">
                            <div class="player-name">${player.name}</div>
                            <small>Sk칩re: ${player.total_score} | Her: ${player.games_played}</small>
                        </div>
                        <div class="actions">
                            <button class="delete" onclick="deletePlayer(${player.id})">Smazat</button>
                        </div>
                    `;
                    playersList.appendChild(li);
                });

                // Aktualizovat select
                const playerSelect = document.getElementById('playerSelect');
                playerSelect.innerHTML = '<option value="">-- Vyberte hr치캜e --</option>';
                players.forEach(player => {
                    const option = document.createElement('option');
                    option.value = player.id;
                    option.textContent = player.name;
                    playerSelect.appendChild(option);
                });
            } catch (error) {
                console.error('Chyba p콏i na캜칤t치n칤 hr치캜콢:', error);
            }
        }

        async function loadLeaderboard() {
            try {
                const response = await fetch('/api/leaderboard');
                const players = await response.json();
                
                const leaderboardBody = document.getElementById('leaderboardBody');
                leaderboardBody.innerHTML = '';
                
                const medals = ['gold', 'silver', 'bronze'];
                players.forEach((player, index) => {
                    const tr = document.createElement('tr');
                    const medalClass = index < 3 ? medals[index] : '';
                    const medalHTML = medalClass ? `<span class="medal ${medalClass}">${index + 1}</span>` : `<span>${index + 1}</span>`;
                    
                    tr.innerHTML = `
                        <td>${medalHTML}</td>
                        <td>${player.name}</td>
                        <td>${player.total_score}</td>
                        <td>${player.games_played}</td>
                        <td>${player.average_score}</td>
                    `;
                    leaderboardBody.appendChild(tr);
                });
            } catch (error) {
                console.error('Chyba p콏i na캜칤t치n칤 leaderboardu:', error);
            }
        }

        async function deletePlayer(playerId) {
            if (!confirm('Opravdu chcete smazat tohoto hr치캜e?')) return;
            
            try {
                await fetch(`/api/players/${playerId}`, { method: 'DELETE' });
                loadPlayers();
                loadLeaderboard();
            } catch (error) {
                console.error('Chyba p콏i maz치n칤 hr치캜e:', error);
            }
        }

        // Formul치콏 pro p콏id치n칤 hr치캜e
        document.getElementById('addPlayerForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const name = document.getElementById('playerName').value;
            
            try {
                const response = await fetch('/api/players', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ name })
                });
                
                const messageDiv = document.getElementById('playerMessage');
                if (response.ok) {
                    messageDiv.innerHTML = '<div class="success">Hr치캜 byl 칰sp캩코n캩 p콏id치n!</div>';
                    document.getElementById('playerName').value = '';
                    loadPlayers();
                    loadLeaderboard();
                    setTimeout(() => messageDiv.innerHTML = '', 3000);
                } else {
                    const error = await response.json();
                    messageDiv.innerHTML = `<div class="error">${error.error}</div>`;
                    setTimeout(() => messageDiv.innerHTML = '', 3000);
                }
            } catch (error) {
                console.error('Chyba:', error);
            }
        });

        // Formul치콏 pro p콏id치n칤 sk칩re
        document.getElementById('addScoreForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const playerId = document.getElementById('playerSelect').value;
            const score = parseInt(document.getElementById('scoreValue').value);
            const notes = document.getElementById('scoreNotes').value;
            
            try {
                const response = await fetch('/api/scores', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ player_id: playerId, score, notes })
                });
                
                const messageDiv = document.getElementById('scoreMessage');
                if (response.ok) {
                    messageDiv.innerHTML = '<div class="success">Sk칩re bylo 칰sp캩코n캩 zaznamen치no!</div>';
                    document.getElementById('scoreValue').value = '';
                    document.getElementById('scoreNotes').value = '';
                    document.getElementById('playerSelect').value = '';
                    loadPlayers();
                    loadLeaderboard();
                    setTimeout(() => messageDiv.innerHTML = '', 3000);
                } else {
                    const error = await response.json();
                    messageDiv.innerHTML = `<div class="error">${error.error}</div>`;
                    setTimeout(() => messageDiv.innerHTML = '', 3000);
                }
            } catch (error) {
                console.error('Chyba:', error);
            }
        });

        // Po캜치te캜n칤 na캜ten칤
        loadPlayers();
        loadLeaderboard();

        // Aktualizovat data ka쬯칳ch 5 sekund
        setInterval(() => {
            loadLeaderboard();
        }, 5000);
    </script>
</body>
</html>
